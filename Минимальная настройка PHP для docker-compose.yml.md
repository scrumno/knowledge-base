#php #backend #devops #nginx 

Сначала настроим сервис PHP в docker-compose.yml
```yml
	# Здесь всё по аналогии с Nginx
	# Детальное описание каждой строки можно найти в заметке по Nginx
	php:
	    build:
	      context: .
	      dockerfile: php.dockerfile
	    volumes:
	      - ./src:/var/www/html
```

^9e0f8b

Так же, необходимо настроить конфигурацию nginx для PHP
Добавим в файл *nginx/default.conf* следующие параметры
```nginx
	# Определяем блок обработки запросов, соотв. регулярному выражению (ко всем файлам, заканчивающимся на .php)
	location ~ \.php$ {
		
		# Проверяем существование запрошенного файла по $uri, если файл не найден, выдаем 404 ошибку
		# *$uri => путь запроса
	    try_files $uri =404;
	    
	    # Предотвращаем передачу несуществующих файлов с помощью регулярного выражения
	    
	    # Подробнее:
	    # *^(.+\php)(/.+)$ => делит URL на две части
	    # **(.+\.php) => путь к файлу, например: /index.php
	    # **(/.+) => дополнительный путь после файла, например: /index.php/params
	    # Результат сохраняется в переменные:
	    # *$fastcgi_script_name => имя скрипта
	    # *$fastcgi_path_info => дополнительный путь
	    
	    # Это позволяет корректно обрабатывать запросы вида /index.php/something
	    fastcgi_split_path_info ^(.+\.php)(/.+)$;
	    
	    # Передаем запрос PHP-препроцессору
	    # Указываем, что запросы отправляются на FastCGI-сервер по адресу PHP:9000.
	    # *php => имя сервиса (например из Docker Compose)
	    # *9000 => порт, на котором работает PHP-FPM
	    # Здесь Nginx перенаправляет PHP-запросы в контейнер PHP для обработки.
	    fastcgi_pass php:9000;
	    
	    # Задаём индексный файл для FastCGI,
	    # если запрос направлен на директорию (например: /), Nginx использует index.php как индексный файл.
	    # Гарантирует, что запросы к директориям автоматически обрабатываются через index.php (например, для Laravel)
	    fastcgi_index index.php;
	    
	    # Подключаем стандартные параметры FastCGI
	    # Импортируем файл /etc/nginx/fastcgi_params, в котором содержутся общие настройки для FastCGI (например: SCRIPT_NAME, REQUEST_METHOD)
	    # Здесь мы добавляем небходимые параметры для взаимодействия Nginx с PHP-FPM
	    include fastcgi_params;
	    
	    # Устанавливаем параметр для PHP-FPM
	    # Здесь мы передаем полный путь к PHP файлу, который нужно выполнить
	    # *$document_root => корневая директория (/var/www/html)
	    # *$fastcgi_script_name => имя PHP-файла
	    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
	    
	    # Передаем дополнительный путь в PHP-FPM
	    # Например: /params. Это позволяет PHP-приложению обрабатывать дополнительные параметры URL
	    fastcgi_param PATH_INFO $fastcgi_path_info;
	}
```

^7a5bc6
